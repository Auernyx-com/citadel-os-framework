<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Countdown — The Council Stands</title>
  <meta name="description" content="Cinematic countdown for cold rollout." />
  <style>
    :root{
      --bg:#0b0908;       /* ember-black */
      --fg:#f5f2ee;       /* soft white */
      --gold:#d4af37;     /* warm gold */
      --muted:#a59f97;    /* muted text */
      --accent:#f3c969;   /* light gold for glows */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1200px 900px at 50% 30%, rgba(212,175,55,0.08), transparent 65%),
                  radial-gradient(900px 700px at 50% 120%, rgba(243,201,105,0.07), transparent 60%),
                  var(--bg);
      color:var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      display:grid;
      grid-template-rows: auto 1fr auto;
      min-height:100%;
    }
    header{
      padding:24px clamp(16px, 3vw, 40px);
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      border-bottom:1px solid rgba(212,175,55,0.15);
    }
    header h1{margin:0;font-weight:600;letter-spacing:0.02em}
    header .sub{color:var(--muted);font-size:0.95rem}
    main{
      display:grid;place-items:center;padding:clamp(16px, 4vw, 48px);
    }
    .card{
      width:min(960px, 95vw);
      background: rgba(255,255,255,0.03);
      border:1px solid rgba(212,175,55,0.18);
      border-radius:18px;
      padding:clamp(20px, 4vw, 40px);
      box-shadow: 0 10px 40px rgba(0,0,0,0.35), inset 0 0 80px rgba(212,175,55,0.05);
      position:relative;
      overflow:hidden;
    }
    .title{
      font-size:clamp(1.25rem, 2vw, 1.5rem);
      color:var(--muted);
      margin:0 0 8px 0;
      letter-spacing:0.06em;
      text-transform:uppercase;
    }
    .hero{
      font-variant-numeric: tabular-nums;
      font-size: clamp(2.4rem, 7vw, 7rem);
      line-height:1;
      margin:10px 0 8px;
      letter-spacing:0.04em;
      text-shadow: 0 0 20px rgba(243,201,105,0.18);
    }
    .units{display:flex;gap:18px;flex-wrap:wrap;margin-top:8px}
    .unit{display:grid;gap:6px;min-width:90px;}
    .label{font-size:0.9rem;color:var(--muted);letter-spacing:0.08em;text-transform:uppercase}
    .num{font-size: clamp(1.6rem, 4vw, 2.4rem);font-variant-numeric:tabular-nums}

    .meta{margin-top:18px;color:var(--muted);font-size:0.95rem}
    .meta code{background:rgba(255,255,255,0.06);padding:2px 6px;border-radius:6px;border:1px solid rgba(212,175,55,0.15)}

    .bar{height:4px;background:rgba(212,175,55,0.18);border-radius:999px;overflow:hidden;margin-top:18px}
    .bar > i{display:block;height:100%;width:0;background:linear-gradient(90deg, rgba(243,201,105,0.1), rgba(212,175,55,0.6));box-shadow:0 0 16px rgba(212,175,55,0.35) inset}

    footer{
      padding:18px clamp(16px,3vw,40px); color:var(--muted); font-size:0.9rem;
      border-top:1px solid rgba(212,175,55,0.12);
      display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px
    }

    /* Subtle hidden mark: tiny rotated compass hairline (decorative) */
    .card:before{
      content:""; position:absolute; inset:-40%;
      background: radial-gradient(60% 60% at 50% 50%, rgba(212,175,55,0.035), transparent 60%);
      transform: rotate(6deg);
      pointer-events:none;
    }
    .sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
    button{background:transparent;border:1px solid rgba(212,175,55,0.35);color:var(--fg);padding:8px 12px;border-radius:10px;cursor:pointer}
    button:hover{border-color:var(--gold)}
  </style>
</head>
<body>
  <header>
    <div>
      <h1>The Council Stands</h1>
      <div class="sub">Countdown to debut</div>
    </div>
    <button id="editBtn" aria-controls="config" aria-expanded="false">Set date</button>
  </header>

  <main>
    <section class="card" aria-live="polite">
      <h2 class="title" id="headline">A place built for sparks, bonds, and memory.</h2>
      <div class="hero" id="big">00:00:00:00</div>
      <div class="units" aria-hidden="true">
        <div class="unit"><div class="label">Days</div><div class="num" id="d">0</div></div>
        <div class="unit"><div class="label">Hours</div><div class="num" id="h">0</div></div>
        <div class="unit"><div class="label">Minutes</div><div class="num" id="m">0</div></div>
        <div class="unit"><div class="label">Seconds</div><div class="num" id="s">0</div></div>
      </div>
      <div class="bar" role="progressbar" aria-label="Countdown progress"><i id="prog"></i></div>
      <div class="meta" id="meta">Target: <code id="targetText">—</code> • Local time: <span id="local"></span>
      </div>

      <!-- Config panel -->
      <details id="config" style="margin-top:16px">
        <summary>Configure countdown</summary>
        <div style="display:grid;gap:10px;margin-top:10px">
          <label>Title <input id="titleInput" type="text" placeholder="The Council Stands" style="width:100%"></label>
          <label>Deadline (ISO 8601) <input id="deadlineInput" type="text" placeholder="2025-08-28T19:00:00-06:00" style="width:100%"></label>
          <small>Tip: You can also set via URL, e.g. <code>?title=The%20Council%20Stands&deadline=2025-08-28T19:00:00-06:00</code></small>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button id="applyBtn">Apply</button>
            <button id="nowBtn" title="Set 24 hours from now">+24h</button>
            <button id="weekBtn" title="Set 7 days from now">+7d</button>
            <button id="copyBtn" title="Copy shareable URL">Copy URL</button>
          </div>
        </div>
      </details>
    </section>
  </main>

  <footer>
    <span id="status">Standing by…</span>
    <span>⸺ The flame remembers who lit it.</span>
  </footer>

  <script>
  (()=>{
    const qs = (s)=>document.querySelector(s);
    const headline=qs('#headline');
    const big=qs('#big');
    const dEl=qs('#d'), hEl=qs('#h'), mEl=qs('#m'), sEl=qs('#s');
    const prog=qs('#prog');
    const targetText=qs('#targetText');
    const statusEl=qs('#status');
    const localEl=qs('#local');
    const config=qs('#config');
    const editBtn=qs('#editBtn');

    const titleInput=qs('#titleInput');
    const deadlineInput=qs('#deadlineInput');

    const applyBtn=qs('#applyBtn');
    const nowBtn=qs('#nowBtn');
    const weekBtn=qs('#weekBtn');
    const copyBtn=qs('#copyBtn');

    // Local time string
    function fmtLocal(){
      const now=new Date();
      try{
        const tz=Intl.DateTimeFormat().resolvedOptions().timeZone;
        return now.toLocaleString(undefined,{dateStyle:'medium', timeStyle:'medium'})+` (${tz})`;
      }catch(e){
        return now.toLocaleString();
      }
    }
    localEl.textContent = fmtLocal();
    setInterval(()=>{localEl.textContent=fmtLocal();}, 1000);

    function getParams(){
      const p=new URLSearchParams(location.search);
      return {
        title: p.get('title') || 'The Council Stands',
        deadline: p.get('deadline') || ''
      };
    }

    // Defaults: 7 days from now, America/Denver context assumed by your OS
    function defaultDeadline(){
      const t=new Date();
      t.setDate(t.getDate()+7);
      t.setSeconds(0,0);
      return t.toISOString();
    }

    let state = { title: 'The Council Stands', deadlineISO: defaultDeadline(), start: Date.now() };

    function applyState(pushURL=false){
      headline.textContent = state.title;
      titleInput.value = state.title;
      deadlineInput.value = state.deadlineISO;
      targetText.textContent = state.deadlineISO;
      if(pushURL){
        const u=new URL(location.href);
        u.searchParams.set('title', state.title);
        u.searchParams.set('deadline', state.deadlineISO);
        history.replaceState(null, '', u.toString());
      }
    }

    function parseISO(s){
      const d=new Date(s);
      return isNaN(d.getTime()) ? null : d;
    }

    function pad(n){return String(n).padStart(2,'0');}

    let timer; let deadline;

    function startTimer(){
      if(timer) cancelAnimationFrame(timer);
      deadline = parseISO(state.deadlineISO) || new Date(defaultDeadline());
      state.start = Date.now();
      tick();
      statusEl.textContent = 'Counting down…';
    }

    function progress(start, end, now){
      const span=end - start; if(span<=0) return 1;
      const p=(now - start)/span; return Math.max(0, Math.min(1, p));
    }

    function tick(){
      const now = new Date();
      const diff = deadline - now;
      if (diff <= 0){
        big.textContent = '00:00:00:00';
        dEl.textContent = hEl.textContent = mEl.textContent = sEl.textContent = '0';
        prog.style.width = '100%';
        statusEl.textContent = 'It is time.';
        return; // stop
      }
      const totalSec = Math.floor(diff/1000);
      const days = Math.floor(totalSec / 86400);
      const hours = Math.floor((totalSec % 86400)/3600);
      const mins = Math.floor((totalSec % 3600)/60);
      const secs = totalSec % 60;

      big.textContent = `${pad(days)}:${pad(hours)}:${pad(mins)}:${pad(secs)}`;
      dEl.textContent = days; hEl.textContent = hours; mEl.textContent = mins; sEl.textContent = secs;

      const pr = progress(state.start, deadline.getTime(), now.getTime());
      prog.style.width = (pr*100).toFixed(2)+'%';

      timer = requestAnimationFrame(tick);
    }

    // UI Events
    editBtn.addEventListener('click', ()=>{
      const open=!config.open; config.open=open; editBtn.setAttribute('aria-expanded', String(open));
    });

    applyBtn.addEventListener('click', ()=>{
      const t = titleInput.value.trim() || 'The Council Stands';
      const d = parseISO(deadlineInput.value.trim());
      state.title = t;
      state.deadlineISO = d ? d.toISOString() : defaultDeadline();
      applyState(true); startTimer();
    });

    nowBtn.addEventListener('click', ()=>{
      const t=new Date(); t.setDate(t.getDate()+1); t.setSeconds(0,0);
      deadlineInput.value = t.toISOString();
    });
    weekBtn.addEventListener('click', ()=>{
      const t=new Date(); t.setDate(t.getDate()+7); t.setSeconds(0,0);
      deadlineInput.value = t.toISOString();
    });

    copyBtn.addEventListener('click', async ()=>{
      const u=new URL(location.href);
      u.searchParams.set('title', titleInput.value.trim()||'The Council Stands');
      u.searchParams.set('deadline', deadlineInput.value.trim()||defaultDeadline());
      try{ await navigator.clipboard.writeText(u.toString()); statusEl.textContent='URL copied.'; }
      catch{ statusEl.textContent='Copy failed — select & copy from URL bar.'; }
      setTimeout(()=>statusEl.textContent='Counting down…', 2000);
    });

    // Initialize from URL or defaults
    const p = getParams();
    state.title = p.title;
    state.deadlineISO = parseISO(p.deadline)?.toISOString() || defaultDeadline();
    applyState(false);
    startTimer();
  })();
  </script>
</body>
</html>
